EditScreen1 As screen:
    OnVisible: =

    FormContainer As groupContainer.manualLayoutContainer:
        Height: =563
        RadiusBottomLeft: =20
        RadiusBottomRight: =20
        RadiusTopLeft: =20
        RadiusTopRight: =20
        Width: =800
        X: =46
        Y: =108
        ZIndex: =1

        Form2 As form:
            DataSource: =TBL_CameraPictureFile
            DefaultMode: =FormMode.View
            Fill: =RGBA(237, 223, 154, 0.87)
            Height: =563
            Item: =Gallery1.Selected
            OnSuccess: =Back()
            ZIndex: =1

            Title_DataCard2 As typedDataCard.textualEditCard:
                BorderColor: =RGBA(0, 121, 187, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="Title"
                Default: =ThisItem.Title
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@TBL_CameraPictureFile],DataSourceInfo.DisplayName,Title)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                MaxLength: =DataSourceInfo([@TBL_CameraPictureFile], DataSourceInfo.MaxLength, Title)
                Required: =false
                Update: =DataCardValue5.Text
                Width: =266
                X: =0
                Y: =0
                ZIndex: =7

                DataCardKey5 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue5 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =1
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(0, 0, 0, 0)
                    HoverColor: =RGBA(0, 121, 187, 1)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    MaxLength: =Parent.MaxLength
                    PaddingLeft: =5
                    PressedColor: =RGBA(255, 255, 255, 1)
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Size: =20
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardKey5.Y + DataCardKey5.Height + 5
                    ZIndex: =2

                ErrorMessage5 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue5.Y + DataCardValue5.Height
                    ZIndex: =3

                StarVisible5 As label:
                    Align: =Align.Center
                    Height: =DataCardKey5.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey5.Y
                    ZIndex: =4

            Description_DataCard2 As typedDataCard.textualEditCard:
                BorderColor: =RGBA(0, 121, 187, 1)
                BorderStyle: =BorderStyle.Solid
                DataField: ="Description"
                Default: =ThisItem.Description
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@TBL_CameraPictureFile],DataSourceInfo.DisplayName,Description)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =153
                MaxLength: =DataSourceInfo([@TBL_CameraPictureFile], DataSourceInfo.MaxLength, Description)
                Required: =false
                Update: =DataCardValue6.Text
                Width: =266
                X: =1
                Y: =0
                ZIndex: =7

                DataCardKey6 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue6 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =1
                    Default: =Parent.Default
                    DelayOutput: =true
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =87
                    HoverColor: =RGBA(0, 121, 187, 1)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    MaxLength: =Parent.MaxLength
                    Mode: =TextMode.MultiLine
                    PaddingLeft: =5
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Size: =20
                    Tooltip: =Parent.DisplayName
                    Width: =206
                    X: =30
                    Y: =DataCardKey6.Y + DataCardKey6.Height + 5
                    ZIndex: =2

                ErrorMessage6 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue6.Y + DataCardValue6.Height
                    ZIndex: =3

                StarVisible6 As label:
                    Align: =Align.Center
                    Height: =DataCardKey6.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey6.Y
                    ZIndex: =4

            Total_Attachments_DataCard2 As typedDataCard.numberEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="Total_Attachments"
                Default: =ThisItem.Total_Attachments
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@TBL_CameraPictureFile],DataSourceInfo.DisplayName,Total_Attachments)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =50
                Required: =false
                Update: =Value(DataCardValue7.Text)
                Width: =266
                X: =2
                Y: =0
                ZIndex: =7

                DataCardKey7 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                DataCardValue7 As text:
                    BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                    Default: =Value(CountRows(DataCardValue8.Attachments))
                    DelayOutput: =true
                    DisplayMode: =DisplayMode.View
                    Fill: =RGBA(0, 0, 0, 0)
                    Format: =TextFormat.Number
                    HoverColor: =RGBA(0, 121, 187, 1)
                    HoverFill: =RGBA(0, 0, 0, 0)
                    OnChange: =true
                    PaddingLeft: =5
                    PressedFill: =
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Size: =20
                    Tooltip: =Parent.DisplayName
                    Width: =Parent.Width - 60
                    X: =39
                    Y: =DataCardKey7.Y + DataCardKey7.Height + 5
                    ZIndex: =2

                ErrorMessage7 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue7.Y + DataCardValue7.Height
                    ZIndex: =3

                StarVisible7 As label:
                    Align: =Align.Center
                    Height: =DataCardKey7.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey7.Y
                    ZIndex: =4

            Attachments_DataCard2 As typedDataCard.attachmentsEditCard:
                BorderStyle: =BorderStyle.Solid
                DataField: ="{Attachments}"
                Default: =colAttachments
                DisplayMode: =Parent.DisplayMode
                DisplayName: =DataSourceInfo([@TBL_CameraPictureFile],DataSourceInfo.DisplayName,Attachments)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =405
                Required: =false
                Update: =DataCardValue8.Attachments
                Width: =798
                X: =0
                Y: =1
                ZIndex: =7

                DataCardKey8 As label:
                    AutoHeight: =true
                    Height: =34
                    Text: =Parent.DisplayName
                    Width: =223
                    Wrap: =false
                    X: =30
                    Y: =10
                    ZIndex: =1

                ErrorMessage8 As label:
                    AutoHeight: =true
                    Height: =10
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =0
                    PaddingRight: =0
                    PaddingTop: =0
                    Text: =Parent.Error
                    Visible: =Parent.DisplayMode=DisplayMode.Edit
                    Width: =Parent.Width - 60
                    X: =30
                    Y: =DataCardValue8.Y + DataCardValue8.Height
                    ZIndex: =3

                StarVisible8 As label:
                    Align: =Align.Center
                    Height: =DataCardKey8.Height
                    Text: ="*"
                    Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                    Width: =30
                    Wrap: =false
                    Y: =DataCardKey8.Y
                    ZIndex: =4

                Label5 As label:
                    Color: =RGBA(0, 16, 96, 1)
                    Text: ="Type"
                    Visible: =Form2.Mode<>FormMode.View && varType="add"
                    Width: =57
                    X: =324
                    Y: =4
                    ZIndex: =7

                TextInput2 As text:
                    BorderColor: =RGBA(0, 121, 187, 1)
                    Default: =""
                    Fill: =RGBA(0, 0, 0, 0)
                    Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="üì∏ Camera" && varType="add"
                    Width: =142
                    X: =418
                    Y: =329
                    ZIndex: =8

                Label5_1 As label:
                    Color: =RGBA(0, 16, 96, 1)
                    Text: ="Name"
                    Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="üì∏ Camera" && varType="add"
                    Width: =67
                    X: =351
                    Y: =329
                    ZIndex: =9

                btnCapurePen As button:
                    Fill: =RGBA(102, 182, 227, 1)
                    OnSelect: |-
                        =Collect(colAttachments,{DisplayName: "Pen "& RandBetween(1,10000) &".jpg",Id: "Pen "& RandBetween(1,10000) &".jpg",Value:PenInput1.Image});Reset(DataCardValue8);
                    Text: ="‚úíÔ∏è Capture"
                    Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="‚úíÔ∏è Pen Input"
                    X: =426
                    Y: =350
                    ZIndex: =13

                "'Clear All Attach' As button":
                    Fill: =RGBA(102, 182, 227, 1)
                    Height: =47
                    HoverFill: =RGBA(0, 94, 146, 1)
                    OnSelect: |-
                        =UpdateContext({ resetAttachments: true });
                        UpdateContext({ resetAttachments: false });
                    Text: ="Reset all attach"
                    Visible: =If(Form2.Mode = FormMode.New, true, false)
                    Width: =171
                    X: =30
                    Y: =350
                    ZIndex: =16

                ContainerAttachDataCardValue As groupContainer.manualLayoutContainer:
                    BorderColor: =RGBA(0, 121, 187, 1)
                    BorderThickness: =1
                    Height: =260
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Width: =237
                    X: =16
                    Y: =69
                    ZIndex: =17

                ContainerCamera As groupContainer.manualLayoutContainer:
                    Height: =245
                    RadiusBottomLeft: =15
                    RadiusBottomRight: =15
                    RadiusTopLeft: =15
                    RadiusTopRight: =15
                    Width: =324
                    X: =344
                    Y: =64
                    ZIndex: =18

                    Camera2 As camera:
                        Camera: =0
                        Height: =247
                        OnSelect: |-
                            =Collect(colAttachments,{DisplayName: "Camera "& TextInput2.Text & ".jpg",Id: "Camera "& TextInput2.Text & ".jpg",Value:Self.Photo});Reset(DataCardValue8);
                        Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="üì∏ Camera" && varType="add"
                        Width: =324
                        ZIndex: =1

                    PenInput1 As inkControl:
                        BorderThickness: =0
                        Color: =RGBA(20, 20, 20, 1)
                        Fill: =RGBA(255, 255, 255, 1)
                        Height: =245
                        Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="‚úíÔ∏è Pen Input"
                        Width: =324
                        ZIndex: =2

                    AddMediaWithImage1 As group:
                        Height: =5
                        Width: =5
                        X: =40
                        Y: =26
                        ZIndex: =5

                        UploadedImage1 As image:
                            Height: =245
                            Image: =If(IsBlank(AddMediaButton1.Media), SampleImage, AddMediaButton1.Media)
                            ImagePosition: =ImagePosition.Fill
                            Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="üñºÔ∏è Upload Image"
                            Width: =324
                            ZIndex: =3

                        AddMediaButton1 As addMedia:
                            ChangePictureText: ="Add Picture"
                            Color: =RGBA(0, 121, 187, 1)
                            Height: =245
                            OnSelect: |-
                                =Collect(colAttachments,{DisplayName: "Picture "& RandBetween(1,10000) &".jpg",Id: "Picture "& RandBetween(1,10000) &".jpg",Value:UploadedImage1.Image});Reset(DataCardValue8)
                            Size: =25
                            Visible: =Form2.Mode<>FormMode.View && Dropdown2.Selected.Value="üñºÔ∏è Upload Image"
                            Width: =324
                            ZIndex: =4

                ContainerDropDown As groupContainer.manualLayoutContainer:
                    BorderColor: =RGBA(0, 121, 187, 1)
                    BorderThickness: =1
                    Height: =37
                    RadiusBottomLeft: =10
                    RadiusBottomRight: =10
                    RadiusTopLeft: =10
                    RadiusTopRight: =10
                    Width: =189
                    X: =394
                    Y: =7
                    ZIndex: =19

                    Dropdown2 As dropdown:
                        ChevronBackground: =RGBA(0, 0, 0, 0)
                        ChevronFill: =RGBA(0, 121, 187, 1)
                        Fill: =RGBA(0, 0, 0, 0)
                        Height: =37
                        Items: =["üì∏ Camera","‚úíÔ∏è Pen Input","üñºÔ∏è Upload Image"]
                        Visible: =Form2.Mode<>FormMode.View && varType="add"
                        Width: =189
                        ZIndex: =1

                DataCardValue8 As attachments:
                    BorderColor: =If(IsBlank(Attachments_DataCard2.Error), Parent.BorderColor, Color.Red)
                    BorderThickness: =0
                    DisplayMode: =Parent.DisplayMode
                    Fill: =RGBA(0, 0, 0, 0)
                    Height: =260
                    IsInDataCard: =true
                    Items: =Parent.Default
                    OnAddFile: |
                        =ClearCollect(
                            colAttachments,
                            Self.Attachments
                        );
                    OnRemoveFile: |
                        =ClearCollect(
                            colAttachments,
                            Self.Attachments
                        );
                    OnUndoRemoveFile: |
                        =ClearCollect(
                            colAttachments,
                            Self.Attachments
                        );
                    PaddingBottom: =5
                    PaddingLeft: =If(Self.DisplayMode = DisplayMode.Edit, 5, 0)
                    PaddingRight: =5
                    PaddingTop: =5
                    Reset: =resetAttachments
                    Tooltip: =Attachments_DataCard2.DisplayName
                    Width: =237
                    X: =16
                    Y: =69
                    ZIndex: =20

    SubmitBtn_1 As button:
        Fill: =RGBA(250, 155, 112, 1)
        HoverFill: =RGBA(168, 0, 0, 1)
        OnSelect: =EditForm(Form2);Set(varType,"remove")
        Text: ="Edit & remove attachments"
        Visible: =Form2.Mode=FormMode.View
        Width: =302
        X: =46
        Y: =702
        ZIndex: =2

    SubmitBtn As button:
        Fill: =RGBA(102, 182, 227, 1)
        HoverFill: =RGBA(0, 94, 146, 1)
        OnSelect: |
            =If(
                Form2.Mode = FormMode.View,
               /* Set(
                    varAttachMode,
                    "collect"
                );*/
               
                EditForm(Form2);
                Set(varType,"add")
               // Adding & removing a dummy record and then triggering the reset of attachments control. Without this, delete actions in attachments card do not work correctly for edit form
              //  Collect(colAttachments,{DisplayName: "test.jpg",Id: "test.jpg",Value:Blank()});Remove(colAttachments,Last(colAttachments));Select(btnReset)
                ,
                SubmitForm(Form2)
            );
        Text: =If(Form2.Mode=FormMode.View,"Edit & add attachments", "Submit")
        Width: =270
        X: =402
        Y: =702
        ZIndex: =3

    Rectangle1 As rectangle:
        Fill: =RGBA(255, 255, 255, 1)
        Height: =259
        Visible: =Form2.Mode=FormMode.Edit && varType="add"
        Width: =38
        X: =260
        Y: =320
        ZIndex: =4

    ContainerViewer As groupContainer.manualLayoutContainer:
        BorderColor: =RGBA(0, 121, 187, 1)
        BorderThickness: =1
        Height: =371
        RadiusBottomLeft: =20
        RadiusBottomRight: =20
        RadiusTopLeft: =20
        RadiusTopRight: =20
        Width: =424
        X: =910
        Y: =108
        ZIndex: =5

        SPListItemAttachmentsViewer_1 As SPListItemAttachmentsViewer:
            Height: =446
            Items: =DataCardValue8.Attachments
            Width: =424

    HeaderContainerEditScreen As groupContainer.manualLayoutContainer:
        Fill: =RGBA(153, 207, 236, 1)
        Height: =78
        Width: =1366
        ZIndex: =6

        Icon1 As icon.BackArrow:
            Color: =RGBA(255, 255, 255, 1)
            Height: =50
            Icon: =Icon.BackArrow
            OnSelect: =Navigate(HomeScreen);
            Width: =50
            X: =36
            Y: =15
            ZIndex: =1

        Label2 As label:
            Align: =Align.Center
            Color: =RGBA(255, 255, 255, 1)
            FontWeight: =FontWeight.Bold
            Height: =50
            Size: =25
            Text: ="Info Attachment"
            Width: =300
            X: =105
            Y: =15
            ZIndex: =2

        Icon2 As icon.Trash:
            Color: =RGBA(255, 255, 255, 1)
            Height: =50
            Icon: =Icon.Trash
            OnSelect: =Remove([@TBL_CameraPictureFile], Gallery1.Selected); If (IsEmpty(Errors([@TBL_CameraPictureFile], Gallery1.Selected)), Back())
            Visible: |
                =If(Form2.Mode = FormMode.View, true, false)
            Width: =50
            X: =1280
            Y: =15
            ZIndex: =5

    "Gallery3 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
        DelayItemLoading: =true
        Height: =216
        Items: =colAttachments
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        ShowNavigation: =true
        TemplatePadding: =0
        TemplateSize: =170
        Width: =320
        X: =987
        Y: =525
        ZIndex: =8

        Image4 As image:
            Height: =167
            Image: =ThisItem.AbsoluteUri
            OnSelect: =Select(Parent)
            RadiusBottomLeft: =8
            RadiusBottomRight: =8
            RadiusTopLeft: =8
            RadiusTopRight: =8
            Width: =324
            Y: =3
            ZIndex: =1

    Label4 As label:
        Text: ="Text"
        X: =790
        Y: =702
        ZIndex: =9

    PDF_Icon As icon.DocumentPDF:
        Color: =RGBA(0, 0, 0, 1)
        Height: =50
        Icon: =Icon.DocumentPDF
        OnSelect: |-
            =Office365Outlook.SendEmailV2(User().Email, "Event Itinerary Report","PDF From Power Apps",{Attachments: Table({Name:"EventItinerary.pdf",ContentBytes:PDF(Gallery3, {ExpandContainers: true})})})
        Width: =50
        X: =910
        Y: =529
        ZIndex: =10

